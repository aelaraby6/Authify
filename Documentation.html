<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Authify - Authentication Module Diagrams</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #0f172a 0%, #1e293b 100%);
            color: #e2e8f0;
            padding: 20px;
            min-height: 100vh;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
        }

        h1 {
            text-align: center;
            font-size: 2.5em;
            margin-bottom: 10px;
            background: linear-gradient(135deg, #3b82f6 0%, #8b5cf6 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .subtitle {
            text-align: center;
            color: #94a3b8;
            margin-bottom: 40px;
            font-size: 1.1em;
        }

        .tabs {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin-bottom: 30px;
            flex-wrap: wrap;
        }

        .tab-btn {
            background: #1e293b;
            border: 2px solid #334155;
            color: #e2e8f0;
            padding: 12px 30px;
            border-radius: 10px;
            cursor: pointer;
            font-size: 16px;
            transition: all 0.3s ease;
            font-weight: 600;
        }

        .tab-btn:hover {
            background: #334155;
            border-color: #3b82f6;
            transform: translateY(-2px);
        }

        .tab-btn.active {
            background: linear-gradient(135deg, #3b82f6 0%, #8b5cf6 100%);
            border-color: #3b82f6;
            box-shadow: 0 5px 20px rgba(59, 130, 246, 0.4);
        }

        .diagram-container {
            display: none;
            background: #1e293b;
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.5);
            border: 1px solid #334155;
        }

        .diagram-container.active {
            display: block;
            animation: fadeIn 0.5s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .diagram-title {
            font-size: 1.8em;
            margin-bottom: 25px;
            color: #3b82f6;
            text-align: center;
        }

        svg {
            width: 100%;
            height: auto;
            display: block;
        }

        .actor {
            fill: #3b82f6;
            stroke: #60a5fa;
            stroke-width: 2;
        }

        .usecase {
            fill: #1e293b;
            stroke: #8b5cf6;
            stroke-width: 2;
        }

        .system-boundary {
            fill: none;
            stroke: #475569;
            stroke-width: 2;
            stroke-dasharray: 5,5;
        }

        .connection {
            stroke: #64748b;
            stroke-width: 2;
            fill: none;
        }

        .text {
            fill: #e2e8f0;
            font-size: 14px;
            font-weight: 500;
        }

        .text-small {
            fill: #cbd5e1;
            font-size: 12px;
        }

        .flow-box {
            fill: #334155;
            stroke: #3b82f6;
            stroke-width: 2;
            rx: 10;
        }

        .decision-box {
            fill: #334155;
            stroke: #f59e0b;
            stroke-width: 2;
        }

        .start-end {
            fill: #10b981;
            stroke: #34d399;
            stroke-width: 2;
        }

        .error-box {
            fill: #334155;
            stroke: #ef4444;
            stroke-width: 2;
            rx: 10;
        }

        .arrow {
            stroke: #64748b;
            stroke-width: 2;
            fill: #64748b;
            marker-end: url(#arrowhead);
        }

        .legend {
            background: #0f172a;
            border: 1px solid #334155;
            border-radius: 10px;
            padding: 15px;
            margin-top: 20px;
        }

        .legend-title {
            font-weight: 600;
            margin-bottom: 10px;
            color: #3b82f6;
        }

        .legend-item {
            display: flex;
            align-items: center;
            margin: 8px 0;
            font-size: 14px;
        }

        .legend-color {
            width: 30px;
            height: 20px;
            margin-right: 10px;
            border-radius: 4px;
            border: 2px solid #475569;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üîê Authify</h1>
        <p class="subtitle">Authentication Module - Use Cases & Flow Diagrams</p>

        <div class="tabs">
            <button class="tab-btn active" onclick="showDiagram('usecase')">Use Case Diagram</button>
            <button class="tab-btn" onclick="showDiagram('auth-flow')">Authentication Flow</button>
            <button class="tab-btn" onclick="showDiagram('password-reset')">Password Reset Flow</button>
            <button class="tab-btn" onclick="showDiagram('oauth-flow')">OAuth Flow</button>
            <button class="tab-btn" onclick="showDiagram('2fa-flow')">2FA Flow</button>
        </div>

        <!-- Use Case Diagram -->
        <div id="usecase" class="diagram-container active">
            <h2 class="diagram-title">Use Case Diagram</h2>
            <svg viewBox="0 0 1200 800">
                <defs>
                    <marker id="arrowhead" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
                        <polygon points="0 0, 10 3, 0 6" fill="#64748b" />
                    </marker>
                </defs>

                <!-- System Boundary -->
                <rect class="system-boundary" x="250" y="50" width="700" height="700" />
                <text class="text" x="550" y="80" text-anchor="middle" font-size="18" fill="#8b5cf6">Authify System</text>

                <!-- Actor -->
                <circle class="actor" cx="100" cy="400" r="30" />
                <line class="actor" x1="100" y1="430" x2="100" y2="480" />
                <line class="actor" x1="100" y1="450" x2="70" y2="480" />
                <line class="actor" x1="100" y1="450" x2="130" y2="480" />
                <line class="actor" x1="100" y1="480" x2="70" y2="520" />
                <line class="actor" x1="100" y1="480" x2="130" y2="520" />
                <text class="text" x="100" y="550" text-anchor="middle">User</text>

                <!-- Use Cases -->
                <ellipse class="usecase" cx="400" cy="120" rx="80" ry="40" />
                <text class="text" x="400" y="125" text-anchor="middle">Sign Up</text>

                <ellipse class="usecase" cx="600" cy="120" rx="80" ry="40" />
                <text class="text" x="600" y="125" text-anchor="middle">Login</text>

                <ellipse class="usecase" cx="800" cy="120" rx="80" ry="40" />
                <text class="text" x="800" y="125" text-anchor="middle">Logout</text>

                <ellipse class="usecase" cx="400" cy="220" rx="90" ry="40" />
                <text class="text" x="400" y="225" text-anchor="middle">OAuth Login</text>

                <ellipse class="usecase" cx="600" cy="220" rx="80" ry="40" />
                <text class="text" x="600" y="220" text-anchor="middle">GitHub</text>
                <text class="text-small" x="600" y="235" text-anchor="middle">Authentication</text>

                <ellipse class="usecase" cx="800" cy="220" rx="80" ry="40" />
                <text class="text" x="800" y="220" text-anchor="middle">Google</text>
                <text class="text-small" x="800" y="235" text-anchor="middle">Authentication</text>

                <ellipse class="usecase" cx="400" cy="340" rx="90" ry="40" />
                <text class="text" x="400" y="345" text-anchor="middle">Setup 2FA</text>

                <ellipse class="usecase" cx="600" cy="340" rx="90" ry="40" />
                <text class="text" x="600" y="345" text-anchor="middle">Verify 2FA</text>

                <ellipse class="usecase" cx="800" cy="340" rx="90" ry="40" />
                <text class="text" x="800" y="345" text-anchor="middle">Reset 2FA</text>

                <ellipse class="usecase" cx="400" cy="460" rx="100" ry="40" />
                <text class="text" x="400" y="465" text-anchor="middle">Forgot Password</text>

                <ellipse class="usecase" cx="600" cy="460" rx="90" ry="40" />
                <text class="text" x="600" y="460" text-anchor="middle">Verify Reset</text>
                <text class="text-small" x="600" y="475" text-anchor="middle">OTP</text>

                <ellipse class="usecase" cx="800" cy="460" rx="90" ry="40" />
                <text class="text" x="800" y="460" text-anchor="middle">Reset</text>
                <text class="text-small" x="800" y="475" text-anchor="middle">Password</text>

                <ellipse class="usecase" cx="500" cy="580" rx="100" ry="40" />
                <text class="text" x="500" y="580" text-anchor="middle">Update</text>
                <text class="text-small" x="500" y="595" text-anchor="middle">Password</text>

                <ellipse class="usecase" cx="700" cy="580" rx="90" ry="40" />
                <text class="text" x="700" y="580" text-anchor="middle">Check Auth</text>
                <text class="text-small" x="700" y="595" text-anchor="middle">Status</text>

                <ellipse class="usecase" cx="500" cy="680" rx="100" ry="40" />
                <text class="text" x="500" y="685" text-anchor="middle">Revoke OAuth</text>

                <!-- Connections -->
                <line class="connection" x1="130" y1="400" x2="320" y2="120" />
                <line class="connection" x1="130" y1="400" x2="520" y2="120" />
                <line class="connection" x1="130" y1="400" x2="720" y2="120" />
                <line class="connection" x1="130" y1="400" x2="310" y2="220" />
                <line class="connection" x1="130" y1="400" x2="310" y2="340" />
                <line class="connection" x1="130" y1="400" x2="510" y2="340" />
                <line class="connection" x1="130" y1="400" x2="710" y2="340" />
                <line class="connection" x1="130" y1="400" x2="300" y2="460" />
                <line class="connection" x1="130" y1="400" x2="510" y2="460" />
                <line class="connection" x1="130" y1="400" x2="710" y2="460" />
                <line class="connection" x1="130" y1="400" x2="410" y2="560" />
                <line class="connection" x1="130" y1="400" x2="620" y2="560" />
                <line class="connection" x1="130" y1="400" x2="410" y2="665" />

                <!-- Extends relationships -->
                <line class="connection" x1="490" y1="220" x2="530" y2="220" stroke-dasharray="5,5" />
                <line class="connection" x1="690" y1="220" x2="730" y2="220" stroke-dasharray="5,5" />
            </svg>

            <div class="legend">
                <div class="legend-title">Legend</div>
                <div class="legend-item">
                    <div class="legend-color" style="background: #3b82f6;"></div>
                    <span>Actor (User)</span>
                </div>
                <div class="legend-item">
                    <div class="legend-color" style="background: #1e293b; border-color: #8b5cf6;"></div>
                    <span>Use Case</span>
                </div>
                <div class="legend-item">
                    <div class="legend-color" style="background: transparent; border-style: dashed;"></div>
                    <span>System Boundary</span>
                </div>
            </div>
        </div>

        <!-- Authentication Flow -->
        <div id="auth-flow" class="diagram-container">
            <h2 class="diagram-title">Authentication Flow (Login)</h2>
            <svg viewBox="0 0 1000 1100">
                <defs>
                    <marker id="arrowhead" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
                        <polygon points="0 0, 10 3, 0 6" fill="#64748b" />
                    </marker>
                </defs>

                <!-- Start -->
                <ellipse class="start-end" cx="500" cy="50" rx="80" ry="30" />
                <text class="text" x="500" y="55" text-anchor="middle">Start</text>

                <!-- User submits credentials -->
                <rect class="flow-box" x="400" y="120" width="200" height="60" />
                <text class="text" x="500" y="145" text-anchor="middle">User Submits</text>
                <text class="text" x="500" y="165" text-anchor="middle">Credentials</text>

                <!-- Validate schema -->
                <rect class="flow-box" x="400" y="220" width="200" height="60" />
                <text class="text" x="500" y="245" text-anchor="middle">Validate Input</text>
                <text class="text-small" x="500" y="265" text-anchor="middle">(LoginSchema)</text>

                <!-- Decision: Valid? -->
                <polygon class="decision-box" points="500,330 600,370 500,410 400,370" />
                <text class="text" x="500" y="375" text-anchor="middle">Valid?</text>

                <!-- Invalid path -->
                <rect class="error-box" x="650" y="340" width="180" height="60" />
                <text class="text" x="740" y="365" text-anchor="middle">Return 400</text>
                <text class="text-small" x="740" y="385" text-anchor="middle">Validation Error</text>

                <!-- Authenticate with Passport -->
                <rect class="flow-box" x="400" y="460" width="200" height="60" />
                <text class="text" x="500" y="485" text-anchor="middle">Passport Local</text>
                <text class="text-small" x="500" y="505" text-anchor="middle">Authentication</text>

                <!-- Decision: User found? -->
                <polygon class="decision-box" points="500,570 600,610 500,650 400,610" />
                <text class="text" x="500" y="615" text-anchor="middle">User Found?</text>

                <!-- Not found path -->
                <rect class="error-box" x="650" y="580" width="180" height="60" />
                <text class="text" x="740" y="605" text-anchor="middle">Return 401</text>
                <text class="text-small" x="740" y="625" text-anchor="middle">Invalid Credentials</text>

                <!-- Create session -->
                <rect class="flow-box" x="400" y="700" width="200" height="60" />
                <text class="text" x="500" y="725" text-anchor="middle">req.login()</text>
                <text class="text-small" x="500" y="745" text-anchor="middle">Create Session</text>

                <!-- Decision: Session OK? -->
                <polygon class="decision-box" points="500,810 600,850 500,890 400,850" />
                <text class="text" x="500" y="855" text-anchor="middle">Session OK?</text>

                <!-- Session error path -->
                <rect class="error-box" x="650" y="820" width="180" height="60" />
                <text class="text" x="740" y="845" text-anchor="middle">Return 500</text>
                <text class="text-small" x="740" y="865" text-anchor="middle">Session Error</text>

                <!-- Login Controller -->
                <rect class="flow-box" x="400" y="940" width="200" height="60" />
                <text class="text" x="500" y="965" text-anchor="middle">LoginController</text>
                <text class="text-small" x="500" y="985" text-anchor="middle">Return Success</text>

                <!-- End -->
                <ellipse class="start-end" cx="500" cy="1050" rx="80" ry="30" />
                <text class="text" x="500" y="1055" text-anchor="middle">End</text>

                <!-- Arrows -->
                <line class="arrow" x1="500" y1="80" x2="500" y2="120" />
                <line class="arrow" x1="500" y1="180" x2="500" y2="220" />
                <line class="arrow" x1="500" y1="280" x2="500" y2="330" />
                <line class="arrow" x1="600" y1="370" x2="650" y2="370" />
                <text class="text-small" x="620" y="360" text-anchor="middle">No</text>
                <line class="arrow" x1="500" y1="410" x2="500" y2="460" />
                <text class="text-small" x="520" y="435" text-anchor="middle">Yes</text>
                <line class="arrow" x1="500" y1="520" x2="500" y2="570" />
                <line class="arrow" x1="600" y1="610" x2="650" y2="610" />
                <text class="text-small" x="620" y="600" text-anchor="middle">No</text>
                <line class="arrow" x1="500" y1="650" x2="500" y2="700" />
                <text class="text-small" x="520" y="675" text-anchor="middle">Yes</text>
                <line class="arrow" x1="500" y1="760" x2="500" y2="810" />
                <line class="arrow" x1="600" y1="850" x2="650" y2="850" />
                <text class="text-small" x="620" y="840" text-anchor="middle">No</text>
                <line class="arrow" x1="500" y1="890" x2="500" y2="940" />
                <text class="text-small" x="520" y="915" text-anchor="middle">Yes</text>
                <line class="arrow" x1="500" y1="1000" x2="500" y2="1020" />
            </svg>
        </div>

        <!-- Password Reset Flow -->
        <div id="password-reset" class="diagram-container">
            <h2 class="diagram-title">Password Reset Flow</h2>
            <svg viewBox="0 0 1200 900">
                <defs>
                    <marker id="arrowhead" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
                        <polygon points="0 0, 10 3, 0 6" fill="#64748b" />
                    </marker>
                </defs>

                <!-- Three parallel flows -->
                
                <!-- Flow 1: Forgot Password -->
                <text class="text" x="200" y="40" text-anchor="middle" fill="#3b82f6" font-size="16">1. Forgot Password</text>
                <ellipse class="start-end" cx="200" cy="80" rx="70" ry="25" />
                <text class="text-small" x="200" y="85" text-anchor="middle">Start</text>

                <rect class="flow-box" x="120" y="140" width="160" height="50" />
                <text class="text-small" x="200" y="160" text-anchor="middle">POST</text>
                <text class="text-small" x="200" y="178" text-anchor="middle">/forgot-password</text>

                <rect class="flow-box" x="120" y="230" width="160" height="50" />
                <text class="text-small" x="200" y="250" text-anchor="middle">Validate Email</text>
                <text class="text-small" x="200" y="268" text-anchor="middle">(Schema)</text>

                <polygon class="decision-box" points="200,320 270,350 200,380 130,350" />
                <text class="text-small" x="200" y="355" text-anchor="middle">Valid?</text>

                <rect class="flow-box" x="120" y="420" width="160" height="50" />
                <text class="text-small" x="200" y="440" text-anchor="middle">Generate OTP</text>
                <text class="text-small" x="200" y="458" text-anchor="middle">& Send Email</text>

                <rect class="flow-box" x="120" y="510" width="160" height="50" />
                <text class="text-small" x="200" y="530" text-anchor="middle">Store OTP</text>
                <text class="text-small" x="200" y="548" text-anchor="middle">with Expiry</text>

                <ellipse class="start-end" cx="200" cy="610" rx="70" ry="25" />
                <text class="text-small" x="200" y="615" text-anchor="middle">End</text>

                <!-- Flow 2: Verify OTP -->
                <text class="text" x="600" y="40" text-anchor="middle" fill="#3b82f6" font-size="16">2. Verify OTP</text>
                <ellipse class="start-end" cx="600" cy="80" rx="70" ry="25" />
                <text class="text-small" x="600" y="85" text-anchor="middle">Start</text>

                <rect class="flow-box" x="520" y="140" width="160" height="50" />
                <text class="text-small" x="600" y="160" text-anchor="middle">POST</text>
                <text class="text-small" x="600" y="178" text-anchor="middle">/verify-reset-otp</text>

                <rect class="flow-box" x="520" y="230" width="160" height="50" />
                <text class="text-small" x="600" y="250" text-anchor="middle">Check Email</text>
                <text class="text-small" x="600" y="268" text-anchor="middle">& OTP</text>

                <polygon class="decision-box" points="600,320 670,350 600,380 530,350" />
                <text class="text-small" x="600" y="355" text-anchor="middle">Valid?</text>

                <rect class="flow-box" x="520" y="420" width="160" height="50" />
                <text class="text-small" x="600" y="440" text-anchor="middle">Generate</text>
                <text class="text-small" x="600" y="458" text-anchor="middle">Reset Token</text>

                <rect class="flow-box" x="520" y="510" width="160" height="50" />
                <text class="text-small" x="600" y="530" text-anchor="middle">Return Token</text>
                <text class="text-small" x="600" y="548" text-anchor="middle">to Client</text>

                <ellipse class="start-end" cx="600" cy="610" rx="70" ry="25" />
                <text class="text-small" x="600" y="615" text-anchor="middle">End</text>

                <!-- Flow 3: Reset Password -->
                <text class="text" x="1000" y="40" text-anchor="middle" fill="#3b82f6" font-size="16">3. Reset Password</text>
                <ellipse class="start-end" cx="1000" cy="80" rx="70" ry="25" />
                <text class="text-small" x="1000" y="85" text-anchor="middle">Start</text>

                <rect class="flow-box" x="920" y="140" width="160" height="50" />
                <text class="text-small" x="1000" y="160" text-anchor="middle">POST</text>
                <text class="text-small" x="1000" y="178" text-anchor="middle">/reset-password</text>

                <rect class="flow-box" x="920" y="230" width="160" height="50" />
                <text class="text-small" x="1000" y="250" text-anchor="middle">Validate Token</text>
                <text class="text-small" x="1000" y="268" text-anchor="middle">& Password</text>

                <polygon class="decision-box" points="1000,320 1070,350 1000,380 930,350" />
                <text class="text-small" x="1000" y="355" text-anchor="middle">Valid?</text>

                <rect class="flow-box" x="920" y="420" width="160" height="50" />
                <text class="text-small" x="1000" y="440" text-anchor="middle">Hash New</text>
                <text class="text-small" x="1000" y="458" text-anchor="middle">Password</text>

                <rect class="flow-box" x="920" y="510" width="160" height="50" />
                <text class="text-small" x="1000" y="530" text-anchor="middle">Update User</text>
                <text class="text-small" x="1000" y="548" text-anchor="middle">Password</text>

                <ellipse class="start-end" cx="1000" cy="610" rx="70" ry="25" />
                <text class="text-small" x="1000" y="615" text-anchor="middle">End</text>

                <!-- Arrows for all flows -->
                <line class="arrow" x1="200" y1="105" x2="200" y2="140" />
                <line class="arrow" x1="200" y1="190" x2="200" y2="230" />
                <line class="arrow" x1="200" y1="280" x2="200" y2="320" />
                <line class="arrow" x1="200" y1="380" x2="200" y2="420" />
                <line class="arrow" x1="200" y1="470" x2="200" y2="510" />
                <line class="arrow" x1="200" y1="560" x2="200" y2="585" />

                <line class="arrow" x1="600" y1="105" x2="600" y2="140" />
                <line class="arrow" x1="600" y1="190" x2="600" y2="230" />
                <line class="arrow" x1="600" y1="280" x2="600" y2="320" />
                <line class="arrow" x1="600" y1="380" x2="600" y2="420" />
                <line class="arrow" x1="600" y1="470" x2="600" y2="510" />
                <line class="arrow" x1="600" y1="560" x2="600" y2="585" />

                <line class="arrow" x1="1000" y1="105" x2="1000" y2="140" />
                <line class="arrow" x1="1000" y1="190" x2="1000" y2="230" />
                <line class="arrow" x1="1000" y1="280" x2="1000" y2="320" />
                <line class="arrow" x1="1000" y1="380" x2="1000" y2="420" />
                <line class="arrow" x1="1000" y1="470" x2="1000" y2="510" />
                <line class="arrow" x1="1000" y1="560" x2="1000" y2="585" />

                <!-- Connection arrows between flows -->
                <line class="arrow" x1="280" y1="610" x2="520" y2="610" stroke-dasharray="5,5" />
                <text class="text-small" x="400" y="600" text-anchor="middle">User receives OTP</text>

                <line class="arrow" x1="680" y1="610" x2="920" y2="610" stroke-dasharray="5,5" />
                <text class="text-small" x="800" y="600" text-anchor="middle">User submits OTP</text>
            </svg>
        </div>

        <!-- OAuth Flow -->
        <div id="oauth-flow" class="diagram-container">
            <h2 class="diagram-title">OAuth Flow (GitHub/Google)</h2>
            <svg viewBox="0 0 1000 1200">
                <defs>
                    <marker id="arrowhead" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
                        <polygon points="0 0, 10 3, 0 6" fill="#64748b" />
                    </marker>
                </defs>

                <!-- Start -->
                <ellipse class="start-end" cx="500" cy="50" rx="80" ry="30" />
                <text class="text" x="500" y="55" text-anchor="middle">Start</text>

                <!-- User clicks OAuth -->
                <rect class="flow-box" x="400" y="120" width="200" height="60" />
                <text class="text" x="500" y="145" text-anchor="middle">User Clicks</text>
                <text class="text-small" x="500" y="165" text-anchor="middle">GitHub/Google Login</text>

                <!-- Clear cookies -->
                <rect class="flow-box" x="400" y="220" width="200" height="60" />
                <text class="text" x="500" y="245" text-anchor="middle">Clear Existing</text>
                <text class="text-small" x="500" y="265" text-anchor="middle">Sessions/Cookies</text>

                <!-- Redirect to OAuth provider -->
                <rect class="flow-box" x="400" y="320" width="200" height="60" />
                <text class="text" x="500" y="340" text-anchor="middle">Redirect to OAuth</text>
                <text class="text-small" x="500" y="360" text-anchor="middle">Provider (GitHub/Google)</text>

                <!-- User authorizes -->
                <rect class="flow-box" x="400" y="420" width="200" height="60" />
                <text class="text" x="500" y="440" text-anchor="middle">User Authorizes</text>
                <text class="text-small" x="500" y="460" text-anchor="middle">Application</text>

                <!-- OAuth callback -->
                <rect class="flow-box" x="400" y="520" width="200" height="60" />
                <text class="text" x="500" y="540" text-anchor="middle">OAuth Callback</text>
                <text class="text-small" x="500" y="560" text-anchor="middle">with Auth Code</text>

                <!-- Passport authenticate -->
                <rect class="flow-box" x="400" y="620" width="200" height="60" />
                <text class="text" x="500" y="640" text-anchor="middle">Passport Strategy</text>
                <text class="text-small" x="500" y="660" text-anchor="middle">Exchange Code for Token</text>

                <!-- Decision: Success? -->
                <polygon class="decision-box" points="500,730 600,770 500,810 400,770" />
                <text class="text" x="500" y="775" text-anchor="middle">Success?</text>

                <!-- Failure path -->
                <rect class="error-box" x="650" y="740" width="200" height="60" />
                <text class="text" x="750" y="765" text-anchor="middle">Redirect to Login</text>
                <text class="text-small" x="750" y="785" text-anchor="middle">with Error</text>

                <!-- Fetch user profile -->
                <rect class="flow-box" x="400" y="860" width="200" height="60" />
                <text class="text" x="500" y="880" text-anchor="middle">Fetch User Profile</text>
                <text class="text-small" x="500" y="900" text-anchor="middle">from Provider</text>

                <!-- Create/Update user -->
                <rect class="flow-box" x="400" y="960" width="200" height="60" />
                <text class="text" x="500" y="980" text-anchor="middle">Create/Update User</text>
                <text class="text-small" x="500" y="1000" text-anchor="middle">in Database</text>

                <!-- Generate tokens -->
                <rect class="flow-box" x="400" y="1060" width="200" height="60" />
                <text class="text" x="500" y="1080" text-anchor="middle">Generate Access &</text>
                <text class="text-small" x="500" y="1100" text-anchor="middle">Refresh Tokens</text>

                <!-- Set cookies & redirect -->
                <rect class="flow-box" x="370" y="1160" width="260" height="60" />
                <text class="text" x="500" y="1185" text-anchor="middle">Set Cookies & Redirect</text>
                <text class="text-small" x="500" y="1205" text-anchor="middle">to Dashboard with Token</text>

                <!-- Arrows -->
                <line class="arrow" x1="500" y1="80" x2="500" y2="120" />
                <line class="arrow" x1="500" y1="180" x2="500" y2="220" />
                <line class="arrow" x1="500" y1="280" x2="500" y2="320" />
                <line class="arrow" x1="500" y1="380" x2="500" y2="420" />
                <line class="arrow" x1="500" y1="480" x2="500" y2="520" />
                <line class="arrow" x1="500" y1="580" x2="500" y2="620" />
                <line class="arrow" x1="500" y1="680" x2="500" y2="730" />
                <line class="arrow" x1="600" y1="770" x2="650" y2="770" />
                <text class="text-small" x="620" y="760" text-anchor="middle">No</text>
                <line class="arrow" x1="500" y1="810" x2="500" y2="860" />
                <text class="text-small" x="520" y="835" text-anchor="middle">Yes</text>
                <line class="arrow" x1="500" y1="920" x2="500" y2="960" />
                <line class="arrow" x1="500" y1="1020" x2="500" y2="1060" />
                <line class="arrow" x1="500" y1="1120" x2="500" y2="1160" />
            </svg>

            <div class="legend">
                <div class="legend-title">OAuth Providers Supported</div>
                <div class="legend-item">
                    <div class="legend-color" style="background: #333;"></div>
                    <span>GitHub OAuth - Full user profile & email access</span>
                </div>
                <div class="legend-item">
                    <div class="legend-color" style="background: #4285f4;"></div>
                    <span>Google OAuth - Profile & email scope</span>
                </div>
            </div>
        </div>

        <!-- 2FA Flow -->
        <div id="2fa-flow" class="diagram-container">
            <h2 class="diagram-title">Two-Factor Authentication (2FA) Flow</h2>
            <svg viewBox="0 0 1200 900">
                <defs>
                    <marker id="arrowhead" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
                        <polygon points="0 0, 10 3, 0 6" fill="#64748b" />
                    </marker>
                </defs>

                <!-- Three parallel flows -->
                
                <!-- Flow 1: Setup 2FA -->
                <text class="text" x="200" y="40" text-anchor="middle" fill="#3b82f6" font-size="16">1. Setup 2FA</text>
                <ellipse class="start-end" cx="200" cy="80" rx="70" ry="25" />
                <text class="text-small" x="200" y="85" text-anchor="middle">Start</text>

                <rect class="flow-box" x="120" y="140" width="160" height="50" />
                <text class="text-small" x="200" y="160" text-anchor="middle">POST /2FA/setup</text>
                <text class="text-small" x="200" y="178" text-anchor="middle">(Authenticated)</text>

                <rect class="flow-box" x="120" y="230" width="160" height="50" />
                <text class="text-small" x="200" y="250" text-anchor="middle">Check Session</text>
                <text class="text-small" x="200" y="268" text-anchor="middle">Authentication</text>

                <polygon class="decision-box" points="200,320 270,350 200,380 130,350" />
                <text class="text-small" x="200" y="355" text-anchor="middle">Valid?</text>

                <rect class="flow-box" x="120" y="420" width="160" height="50" />
                <text class="text-small" x="200" y="440" text-anchor="middle">Generate Secret</text>
                <text class="text-small" x="200" y="458" text-anchor="middle">(speakeasy)</text>

                <rect class="flow-box" x="120" y="510" width="160" height="50" />
                <text class="text-small" x="200" y="530" text-anchor="middle">Generate QR Code</text>
                <text class="text-small" x="200" y="548" text-anchor="middle">& Return to User</text>

                <rect class="flow-box" x="120" y="600" width="160" height="50" />
                <text class="text-small" x="200" y="620" text-anchor="middle">User Scans QR</text>
                <text class="text-small" x="200" y="638" text-anchor="middle">in Authenticator App</text>

                <ellipse class="start-end" cx="200" cy="700" rx="70" ry="25" />
                <text class="text-small" x="200" y="705" text-anchor="middle">End</text>

                <!-- Flow 2: Verify 2FA -->
                <text class="text" x="600" y="40" text-anchor="middle" fill="#3b82f6" font-size="16">2. Verify 2FA</text>
                <ellipse class="start-end" cx="600" cy="80" rx="70" ry="25" />
                <text class="text-small" x="600" y="85" text-anchor="middle">Start</text>

                <rect class="flow-box" x="520" y="140" width="160" height="50" />
                <text class="text-small" x="600" y="160" text-anchor="middle">POST /2FA/verify</text>
                <text class="text-small" x="600" y="178" text-anchor="middle">(Authenticated)</text>

                <rect class="flow-box" x="520" y="230" width="160" height="50" />
                <text class="text-small" x="600" y="250" text-anchor="middle">User Enters</text>
                <text class="text-small" x="600" y="268" text-anchor="middle">TOTP Code</text>

                <rect class="flow-box" x="520" y="320" width="160" height="50" />
                <text class="text-small" x="600" y="340" text-anchor="middle">Verify Token</text>
                <text class="text-small" x="600" y="358" text-anchor="middle">Against Secret</text>

                <polygon class="decision-box" points="600,410 670,440 600,470 530,440" />
                <text class="text-small" x="600" y="445" text-anchor="middle">Valid?</text>

                <rect class="error-box" x="720" y="410" width="140" height="50" />
                <text class="text-small" x="790" y="430" text-anchor="middle">Return Error</text>
                <text class="text-small" x="790" y="448" text-anchor="middle">Invalid Code</text>

                <rect class="flow-box" x="520" y="510" width="160" height="50" />
                <text class="text-small" x="600" y="530" text-anchor="middle">Enable 2FA</text>
                <text class="text-small" x="600" y="548" text-anchor="middle">for User Account</text>

                <rect class="flow-box" x="520" y="600" width="160" height="50" />
                <text class="text-small" x="600" y="620" text-anchor="middle">Return Success</text>
                <text class="text-small" x="600" y="638" text-anchor="middle">2FA Enabled</text>

                <ellipse class="start-end" cx="600" cy="700" rx="70" ry="25" />
                <text class="text-small" x="600" y="705" text-anchor="middle">End</text>

                <!-- Flow 3: Reset 2FA -->
                <text class="text" x="1000" y="40" text-anchor="middle" fill="#3b82f6" font-size="16">3. Reset 2FA</text>
                <ellipse class="start-end" cx="1000" cy="80" rx="70" ry="25" />
                <text class="text-small" x="1000" y="85" text-anchor="middle">Start</text>

                <rect class="flow-box" x="920" y="140" width="160" height="50" />
                <text class="text-small" x="1000" y="160" text-anchor="middle">POST /2FA/reset</text>
                <text class="text-small" x="1000" y="178" text-anchor="middle">(Authenticated)</text>

                <rect class="flow-box" x="920" y="230" width="160" height="50" />
                <text class="text-small" x="1000" y="250" text-anchor="middle">Verify User</text>
                <text class="text-small" x="1000" y="268" text-anchor="middle">Session</text>

                <polygon class="decision-box" points="1000,320 1070,350 1000,380 930,350" />
                <text class="text-small" x="1000" y="355" text-anchor="middle">Valid?</text>

                <rect class="flow-box" x="920" y="420" width="160" height="50" />
                <text class="text-small" x="1000" y="440" text-anchor="middle">Remove 2FA</text>
                <text class="text-small" x="1000" y="458" text-anchor="middle">Secret</text>

                <rect class="flow-box" x="920" y="510" width="160" height="50" />
                <text class="text-small" x="1000" y="530" text-anchor="middle">Disable 2FA</text>
                <text class="text-small" x="1000" y="548" text-anchor="middle">for Account</text>

                <rect class="flow-box" x="920" y="600" width="160" height="50" />
                <text class="text-small" x="1000" y="620" text-anchor="middle">Return Success</text>
                <text class="text-small" x="1000" y="638" text-anchor="middle">2FA Disabled</text>

                <ellipse class="start-end" cx="1000" cy="700" rx="70" ry="25" />
                <text class="text-small" x="1000" y="705" text-anchor="middle">End</text>

                <!-- Arrows for all flows -->
                <line class="arrow" x1="200" y1="105" x2="200" y2="140" />
                <line class="arrow" x1="200" y1="190" x2="200" y2="230" />
                <line class="arrow" x1="200" y1="280" x2="200" y2="320" />
                <line class="arrow" x1="200" y1="380" x2="200" y2="420" />
                <line class="arrow" x1="200" y1="470" x2="200" y2="510" />
                <line class="arrow" x1="200" y1="560" x2="200" y2="600" />
                <line class="arrow" x1="200" y1="650" x2="200" y2="675" />

                <line class="arrow" x1="600" y1="105" x2="600" y2="140" />
                <line class="arrow" x1="600" y1="190" x2="600" y2="230" />
                <line class="arrow" x1="600" y1="280" x2="600" y2="320" />
                <line class="arrow" x1="600" y1="370" x2="600" y2="410" />
                <line class="arrow" x1="670" y1="440" x2="720" y2="440" />
                <text class="text-small" x="690" y="430" text-anchor="middle">No</text>
                <line class="arrow" x1="600" y1="470" x2="600" y2="510" />
                <text class="text-small" x="620" y="490" text-anchor="middle">Yes</text>
                <line class="arrow" x1="600" y1="560" x2="600" y2="600" />
                <line class="arrow" x1="600" y1="650" x2="600" y2="675" />

                <line class="arrow" x1="1000" y1="105" x2="1000" y2="140" />
                <line class="arrow" x1="1000" y1="190" x2="1000" y2="230" />
                <line class="arrow" x1="1000" y1="280" x2="1000" y2="320" />
                <line class="arrow" x1="1000" y1="380" x2="1000" y2="420" />
                <line class="arrow" x1="1000" y1="470" x2="1000" y2="510" />
                <line class="arrow" x1="1000" y1="560" x2="1000" y2="600" />
                <line class="arrow" x1="1000" y1="650" x2="1000" y2="675" />

                <!-- Info note -->
                <rect fill="#0f172a" stroke="#3b82f6" stroke-width="2" x="350" y="780" width="500" height="80" rx="10" />
                <text class="text" x="600" y="805" text-anchor="middle" fill="#3b82f6">2FA Security Note</text>
                <text class="text-small" x="600" y="830" text-anchor="middle">Time-based One-Time Password (TOTP) algorithm</text>
                <text class="text-small" x="600" y="850" text-anchor="middle">Compatible with Google Authenticator, Authy, etc.</text>
            </svg>
        </div>
    </div>

    <script>
        function showDiagram(diagramId) {
            const diagrams = document.querySelectorAll('.diagram-container');
            diagrams.forEach(diagram => {
                diagram.classList.remove('active');
            });

            const buttons = document.querySelectorAll('.tab-btn');
            buttons.forEach(button => {
                button.classList.remove('active');
            });

            const selectedDiagram = document.getElementById(diagramId);
            if (selectedDiagram) {
                selectedDiagram.classList.add('active');
            }

            event.target.classList.add('active');
        }
    </script>
</body>
</html>